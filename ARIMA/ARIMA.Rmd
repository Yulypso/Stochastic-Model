---
title: "TP1 Séries temporelles"
author: "Thierry KHAMPHOUSONE IA1"
output:
  pdf_document: default
  html_notebook: default
---

# Partie 1: Simulation de processus ARMA

### 1) Donner la définition d'un processus ARMA(p, q), Quelles sont les conditions sur les coefficients pour que ce processus soit stationnaire?

=> ARMA: Modèles autorégressifs et moyenne mobile d'ordre p,q est défini par:  
![Processus ARMA](./images//ARMA.png)  
  
Pour que ce processus X_t soit stationnaire du second ordre (faiblement stationnaire) si pour X_t et t appartenant à T on a sa variance, sa moyenne et sa covariance qui sont indépendantes du temps. C'est-à-dire d'avoir une espérance constante, une variance constante finie.
  
Il faut que:  
    1. a_p != 0 et b_q !=0  
    2. a et b ne doivent pas avoir de racines communes et de modules > 1  
    3. epsilon doit être un bruit blanc de variance sigma^2 (est un processus stationnaire)

De ce fait pour avoir un processus stationnaire, il faut que les coefficients composée par le calcul des AR et MA soient inférieur strictement à 1 en valeur absolue.  
Un processus MA(q) est toujours stationnaire.
    
### 2) En utilisant la fonction R arima.sim, simuler plusieurs processus AR_p et MA_q (p et q d’un faible ordre de grandeur, c'est-à-dire [1,10[). Rappeler la formule mathématique des processus à simuler et vérifier que le choix de p et q respecte les conditions de stationnarité.


#### Simulation d'un processus AR(p)

=> AR(p): Processus autorégressif d'ordre p
![Processus AR(p)](./images//AR_p.png)

Simulons un processus AR(4) par exemple : X_t = 0.9X_t-1 - 0.5X_t-2 + 0.4X_t-3 - 0.2X_t-4

```{r}
ts_ar.sim <- arima.sim(n = 100, list(ar = c(0.9, -0.5, 0.4, -0.2)))
ts.plot(ts_ar.sim)
```
 
Nous avons bien tous nos coefficients a_i pour AR inférieur strictement à 1 en valeur absolue.


#### Simulation d'un processus MA(q)

=> MA(q): Processus moyenne mobile d'ordre q
![Processus MA(q)](./images//MA_q.png)

Simulons un processus MA(4) par exemple : X_t = 0.7Z_t-1 - 0.6Z_t-2 - 0.4Z_t-3 + 0.7Z_t-4

```{r}
ts_ma.sim <- arima.sim(n = 100, list(ma = c(0.7, -0.6, -0.4, 0.7)))
ts.plot(ts_ma.sim)
```

Nous avons bien tous nos coefficients b_i pour MA inférieur strictement à 1 en valeur absolue.


### 3) Observer les auto-corrélations empiriques. Que constatez-vous?

```{r}
acf_ar <- acf(ts_ar.sim, type=('correlation'))
```

Pour l'autocorrélation empirique du processus AR semble particulièrement forte pour les décalages 1, 2 et 3.  
0 étant une auto-corrélation avec lui-même d'où la valeur de 1.0 maximale. L'autocorrélation empirique semble être périodique. Les décalages 5, 6, 7 et 8 ont une corrélation plus faible voir nulle.  


```{r}
acf_ma <- acf(ts_ma.sim, type=('correlation'))
```
Pour l'autocorrélation empirique du processus MA semble être très peu corrélée à pour chaque décalage.L'autocorrélation empirique semble être périodique. 


La période d'autocorrélation empirique du processus AR donnée par le décalage est plus grande que la période d'autocorrélation empirique du processus MA. 



### 4) Simuler plusieurs ARMAp,q. Observer et interpréter les auto-corrélations empiriques.

```{r}
ts_arma1.sim <- arima.sim(n = 100, list(ar = c(0.9, -0.5, 0.4, -0.2), ma = c(0.7, -0.6, -0.4, 0.7)))
ts.plot(ts_arma1.sim)

ts_arma2.sim <- arima.sim(n = 100, list(ar = c(0.5, 0.4, -0.8), ma = c(0.4, -0.9, -0.7)))
ts.plot(ts_arma2.sim)
```

```{r}
acf_arma1 <- acf(ts_arma1.sim, type=('correlation'))
acf_arma2 <- acf(ts_arma2.sim, type=('correlation'))
```

Pour l'ARMA1, on observe une faible corrélation empirique à partir du 5 eme décalage. 
0 étant une auto-corrélation avec lui-même d'où la valeur de 1.0 maximale.

Pour l'ARMA2, on observe une faible corrélation empirique aux retards 2, 6, 10, 11 et 18.
0 étant une auto-corrélation avec lui-même d'où la valeur de 1.0 maximale.

# Partie II : Analyse des précipitations mensuelles à San Francisco Charger les données depuis le fichier sanfran.dat, disponible sur le moodle.

## 1)
### a) La série temporelle est-elle stationnaire? Si non, la modifier pour qu’elle le devienne et sauvegarder cette série temporelle dans une nouvelle variable.

### b) Proposer un modèle AR_p ou AM_q adapté sur ces données. Valider la modélisation en testant les résidus.

### 2) En utilisant les données d’origine de 1932 à 1963, tester un modèle AR_2 avec une composante saisonnière, c’est-à-dire un modèle SARIMA_2,0,0,12.

### 3) Calculer et afficher les résidus du modèle SARIMA_2,0,0,12.

### 4) Utiliser le modèle précédent pour prédire les précipitations mensuelles de 1964, 1965 et 1966. Superposer sur un graphique les prédictions et les valeurs réelles.

### 5) Faire de même pour le modèle AR_2 proposé dans la partie 1), sur les données correspondantes.

### 6) Quel est le meilleur modèle de prédiction, graphiquement?

### 7) Comment valider, objectivement, la réponse précédente? Mettre en place ces tests et comparer les résultats à ceux obtenus graphiquement.




  